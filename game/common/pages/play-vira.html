<form id="form" class="form-horizontal">
    <div class="row">
        <div class="form-group">
            <div class="col-sm-4 col-sm-offset-4">
                <label for="user">Name:</label>
                <input id="user" type="text" class="form-control">
            </div>
        </div>
        <div class="form-group" style="padding-top: 15px;">
            <div class="col-sm-4 col-sm-offset-4">
                <label for="sel1">Gambling Probability:</label>
                <select class="form-control" id="sel1">
                    <option>1/5</option>
                    <option>1/6</option>
                    <option>1/7</option>
                    <option>1/8</option>
                    <option>1/9</option>
                    <option>1/10</option>
                    <option>1/11</option>
                    <option>1/12</option>
                    <option>1/13</option>
                </select>
            </div>
        </div>
        <button id="play" class="btn btn-link" style="font-size: 200%; padding-top: 15px;"><span><i class="fa fa-gamepad fa-2x" aria-hidden="true"></i></span> PLAY</button>
    </div>
</form>
<!-- Back to menu button -->
<div class="row"><a id="btnBackMenu" class="btn btn-link" href="#"><span><i class="fa fa-angle-left fa-1x" aria-hidden="true"></i></span> Back to menu</a></div>
<script>
    $(function () {
        $('#play').click(function () {
            var players = [];

            function restoreLocalStorage() {
                for (var i = 0; i < localStorage.length; i++) {
                    var key = localStorage.key(i);
                    var y = JSON.parse(localStorage.getItem(key));
                    players.push(y);
                }
            }
            if (localStorage.length != 0) {
                restoreLocalStorage();
            }
            // Create object players with player info
            var player = {};
            if (players.length == 0) {
                player.name = $("#user").val();
                player.money = 100;
                player.probability = $("#sel1 option:selected").text();
                player.timestamp = new Date().getTime() / 1000;
                players.push(player);
            } else {
                var exists = false;
                var index = 0;
                for (var i = 0; i < players.length; i++) {
                    var tempName = $("#user").val();
                    var tempPlayer = players[i];
                    if (tempPlayer.name == tempName) {
                        exists = true;
                        index = i;
                    }
                }
                if (exists == true) {
                    players[index].probability = $("#sel1 option:selected").text();
                    players[index].timestamp = new Date().getTime() / 1000;
                    if (players[index].money < 1) {
                        players[index].money = 1;
                    }
                } else if (exists == false) {
                    player.name = $("#user").val();
                    player.money = 100;
                    player.probability = $("#sel1 option:selected").text();
                    player.timestamp = new Date().getTime() / 1000;
                    players.push(player);
                }
            }

            // Save on localstorage
            function saveLocalStorage() {
                // Check browser support
                if (typeof (Storage) !== "undefined") {
                    // Store
                    for (var i = 0; i < players.length; i++) {
                        localStorage.setItem(i.toString(), JSON.stringify(players[i]));
                    }
                } else {
                    console.log("Error", "Sorry, your browser does not support Web Storage...", "error");
                }
            }
            saveLocalStorage();

            window.location.replace('common/games/vira/vira.html');
        });
        $('#btnBackMenu').click(function () {
            location.reload();
        });
    });
</script>